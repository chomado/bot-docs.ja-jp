---
title: Bot Framework の ID に関するガイド | Microsoft Docs
description: このガイドでは、Bot Framework v3 プロトコルに存在する ID フィールドの特性について説明します。
keywords: ID, ボット, プロトコル
author: RobStand
ms.author: kamrani
manager: kamrani
ms.topic: article
ms.prod: bot-framework
ms.date: 12/13/2017
ms.openlocfilehash: e32adc96efc21db59e2663e0a19483a2133c0531
ms.sourcegitcommit: f576981342fb3361216675815714e24281e20ddf
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/18/2018
ms.locfileid: "39303009"
---
# <a name="id-fields-in-the-bot-framework"></a>Bot Framework の ID フィールド

このガイドでは、Bot Framework に存在する ID フィールドの特性について説明します。

## <a name="channel-id"></a>チャネル ID

各 Bot Framework チャネルは一意の ID で識別されます。

例: `"channelId": "skype"`

チャネル ID は、その他の ID の名前空間として機能します。 Bot Framework プロトコルのランタイム呼び出しは、チャネルのコンテキスト内で行われる必要があります。チャネルによって、通信時に使用される会話およびアカウント ID に意味が与えられます。

規則により、チャネル ID はすべて小文字になります。 チャネルにより、生成されるチャネル ID の大文字と小文字の一貫性が保証されます。したがって、ボットでは序数に基づく比較を使用して、等価性を確立することができます。

### <a name="rules-for-channel-ids"></a>チャネル ID の規則

- チャネル ID には大文字と小文字の区別があります。

## <a name="bot-handle"></a>ボット ハンドル

Bot Framework に登録されているボットにはそれぞれボット ハンドルがあります。

例: `FooBot`

ボット ハンドルは、オンラインの Bot Framework へのボットの登録を表します。 この登録は HTTP Webhook のエンドポイントと、チャネルへの登録に関連付けられています。

Bot Framework 開発ポータルでは、ボット ハンドルの一意性が確保されます。 ポータルでは大文字と小文字を区別しない一意性の確認が行われます (つまり、大文字と小文字にバリエーションがあるボット ハンドルが単一のハンドルとして扱われる) が、これは開発ポータルの特性であり、ボット ハンドル自体の特性とは限りません。

### <a name="rules-for-bot-handles"></a>ボット ハンドルの規則

* ボット ハンドルは Bot Framework 内で一意のものです (大文字と小文字は区別されない)。

## <a name="app-id"></a>アプリケーション ID

Bot Framework に登録されているボットにはそれぞれアプリケーション ID があります。

> [!NOTE]
> 以前は、アプリは一般的に "MSA アプリ" や "MSA/AAD アプリ" と呼ばれていました。 現在、アプリはより一般的に単に "アプリ" と呼ばれますが、一部のプロトコル要素では永続的に "MSA アプリ" と呼ばれる可能性があります。

例: `"msaAppId": "353826a6-4557-45f8-8d88-6aa0526b8f77"`

各アプリは ID チームのアプリ ポータルへの登録を表し、Bot Framework ランタイム プロトコル内のサービス間識別メカニズムとして機能します。 アプリには、Web サイト、モバイル アプリケーション、デスクトップ アプリケーションなど、ボット以外の他の関連付けがある場合があります。

登録されている各ボットにはアプリが 1 つだけあります。 ボットに関連付けられているアプリをボット所有者が個別に変更することはできませんが、少数の例外的な場合において、Bot Framework チームで変更することができます。

ボットとチャネルではアプリ ID を使用して、登録されたボットを一意に識別する場合があります。

アプリケーション ID は必ず GUID となります。 アプリケーション ID は大文字と小文字を区別せずに比較する必要があります。

### <a name="rules-for-app-ids"></a>アプリ ID の規則

* アプリケーション ID は Microsoft アプリ プラットフォーム内で一意のものです (GUID と比較)。
* 各ボットには対応するアプリが 1 つだけあります。
* ボットが関連付けられるアプリを変更するには、Bot Framework チームの支援が必要です。

## <a name="channel-account"></a>チャネル アカウント

ボットとユーザーのアカウントはそれぞれ各チャネル内に存在します。 アカウントには識別子 (`id`) とその他の有益なボットの非構造データ (オプション名など) が含まれます。

例: `"from": { "id": "john.doe@contoso.com", "name": "John Doe" }`

このアカウントは、メッセージが送受信される可能性のあるチャネル内のアドレスを示しています。 場合によっては、これらの登録が単一サービス (Skype や Facebook など) 内に存在します。 多くのシステム (メール アドレスや電話番号) 間で登録される場合もあります。 匿名チャネル (Web チャットなど) では、登録は一時的なものである場合があります。

チャネル アカウントはチャネル内で入れ子になります。 たとえば、Facebook アカウントは単なる数字です。 この数字には他のチャネルでは異なる意味がある場合があり、すべてのチャネルの外部では意味はありません。

チャネル アカウントと (実際の) ユーザー間の関係は、各チャネルに関連付けられている規則によって異なります。 たとえば、SMS 番号は通常、一定期間において 1 人のユーザーを指し、その期間が過ぎると、この番号は他のユーザーに転送される場合があります。 これに対して、Facebook アカウントは通常、永続的に 1 人のユーザーを指しますが、Facebook アカウントを 2 人のユーザーが共有することは珍しくありません。

ほとんどのチャネルでは、チャネル アカウントは、メッセージを配信できるメールボックスのようなものと考えるのが妥当です。 ほとんどのチャネルでは複数のアドレスを単一のメールボックスにマップできるのが一般的です。たとえば、"jdoe@contoso.com" と "john.doe@service.contoso.com" は同じ受信トレイに解決されます。 一部のチャネルではさらに一歩先を行き、アクセスしているボットに基づいてアカウントのアドレスが変更されます。たとえば、Skype と Facebook の両方でユーザー ID を変更し、各ボットでメッセージの送受信用に異なるアドレスを利用できるようにします。

場合によってはアドレス間の同等性を確立することはできますが、メールボックス間やユーザー間の同等性を確立するには、チャネル内の規則についての知識が必要になり、多くの場合、確立することはできません。

ボットに送信されるアクティビティの `recipient` フィールドを通じて、そのチャネル アカウント アドレスがボットに通知されます。

### <a name="rules-for-channel-accounts"></a>チャネル アカウントの規則

* チャネル アカウントはそれに関連付けられたチャネル内でのみ意味を持ちます。
* 複数の ID が同じアカウントに解決される可能性があります。
* 2 つの ID が同じであることを確立するために、序数に基づく比較を使用できます。
* 通常、2 つの異なる ID が同じアカウント、ボットまたはユーザーに解決されるかどうかを識別するために使用できる比較はありません。
* ID、アカウント、メールボックス、およびユーザーの間の関連付けの安定性はチャネルによって異なります。

## <a name="conversation-id"></a>会話 ID

メッセージは、ID で特定できる、会話のコンテキストで送受信されます。

例: `"conversation": { "id": "1234" }`

会話には、メッセージの交換やその他のアクティビティが含まれます。 各会話に 0 個以上のアクティビティがあり、アクティビティはそれぞれ 1 つの会話にのみ存在します。 会話は永続的である場合や、開始と終了が異なる場合があります。 会話の作成、変更、終了のプロセスはチャネル内で発生し (つまり、会話はチャネルで認識されている場合に存在する)、これらのプロセスの特性はチャネルによって確立されます。

会話内のアクティビティはユーザーとボットによって送信されます。 会話に "参加する" ユーザーの定義はチャネルによって異なり、理論的には、存在するユーザー、メッセージを受信したことがあるユーザー、メッセージを送信したユーザーを含めることができます。

いくつかのチャネル (たとえば、SMS や Skype、場合によってはそれ以外のチャネル) には、1 対 1 の会話に割り当てられている会話 ID がリモート チャネル アカウント ID であるという特質があります。 この特質には以下の 2 つの副作用があります。
1. 会話 ID は、それを表示しているユーザーに基づく主観的なものです。 参加者の A と B が会話している場合、参加者 A は会話 ID が "B" であることを認識し、参加者 B は会話 ID が "A" であることを認識します。
2. ボットにこのチャネル内の複数のチャネル アカウントがある場合 (たとえば、ボットに 2 つの SMS 番号がある場合)、ボットの視野内で会話を一意に識別するには会話 ID では十分ではありません。

したがって、単一ボットの場合でも、会話 ID によって、チャネル内の単一の会話が一意に識別されるとは限りません。

### <a name="rules-for-conversation-ids"></a>会話 ID の規則

* 会話はそれに関連付けられたチャネル内でのみ意味を持ちます。
* 複数の ID が同じ会話に解決される可能性があります。
* 序数の等価性によって、2 つの会話 ID が同じ会話であることが確立されるとは限りませんが、ほとんどの場合、確立されます。

## <a name="activity-id"></a>アクティビティ ID

アクティビティは Bot Framework プロトコル内で送受信され、これらを特定できる場合があります。

例: `"id": "5678"`

アクティビティ ID は省略可能であり、後続の API 呼び出し (使用可能な場合) で ID を参照する方法をボットに示すためにチャネルによって使用されます。
* 特定のアクティビティへの返信
* アクティビティ レベルでの参加者の一覧に対するクエリの実行

確立されているユース ケースはこれ以上ないため、アクティビティ ID の処理に関する追加の規則はありません。
